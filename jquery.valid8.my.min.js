(function(n){function r(t){n(t).data("loadings",[]);n(t).data("errors",[]);n(t).data("valids",[]);n(t).data("keypressTimer",null)}function o(n){r(n);s(n)}function s(t){var i=n(t).data("settings").validationEvents;typeof i=="string"?n(t)[i](function(n){f(n,t)}):n.each(i,function(i,r){n(t)[r](function(n){f(n,t)})})}function i(n){r(n);var t;t=n.type=="checkbox"?n.checked.toString():n.value;h(t.replace(/^[ \t]+|[ \t]+$/,""),n)}function h(i,r){n.each(n(r).data("settings").regularExpressions,function(t,u){u.expression.test(i)?u.validmessage&&(n(r).data("valids")[n(r).data("valids").length]=u.validmessage):n(r).data("errors")[n(r).data("errors").length]=u.errormessage});n(r).data("errors").length>0?t(r,"error",!1):n(r).data("settings").jsFunctions.length>0?c(i,r):n(r).data("settings").ajaxRequests.length>0?u(i,r):t(r,"valid",!0)}function c(i,r){n.each(n(r).data("settings").jsFunctions,function(t,u){var o,f;u.values&&typeof u.values=="function"&&(o=u.values());f=o||i;e(r,u);u["function"](f).valid?n(r).data("valids")[n(r).data("valids").length]=u["function"](f).message:n(r).data("errors")[n(r).data("errors").length]=u["function"](f).message});n(r).data("errors").length>0?t(r,"error",!1):n(r).data("settings").ajaxRequests.length>0?u(i,r):t(r,"valid",!0)}function u(i,r){n.each(n(r).data("settings").ajaxRequests,function(u,f){var o,s;f.values&&typeof f.values=="function"&&(o=f.values());s=o||{value:i};e(r,f);n.post(f.url,s,function(i){i.valid?n(r).data("valids")[n(r).data("valids").length]=i.message||f.validmessage||"":n(r).data("errors")[n(r).data("errors").length]=i.message||f.errormessage||"";n(r).data("errors").length>0?t(r,"error",!1):t(r,"valid",!0)},"json")})}function f(t,r){t.keyCode?(clearTimeout(n(r).data("keypressTimer")),n(r).data("keypressTimer",setTimeout(function(){i(r)},n(r).data("settings").validationFrequency))):i(r)}function e(i,r){r.loadingmessage&&(n(i).data("loadings")[n(i).data("loadings").length]=r.loadingmessage,t(i,"loading",!1))}function t(t,i,r){var f=i.substring(0,1).toUpperCase()+i.substring(1,i.length),u=n(t).data(i+"s");n(t).data(i,r);v(t,i);l(t,i);a(u,t);n(t).trigger(i,[u,t,i])}function l(t,i){var r=n(t).parent();r[0].className=(r[0].className.replace(/(^\s|(\s*(loading|error|valid)))/g,"")+" "+i).replace(/^\s/,"")}function a(t,i){var u=n(i).parent(),r=i.id+"ValidationMessage";!n("#"+r).length>0&&u.append('<span id="'+r+'" class="validationMessage"><\/span>');n("#"+r).html("");n("#"+r).text(t[0])}function v(t,i){i=="valid"?n(t).data("valid",!0):i=="error"&&n(t).data("valid",!1)}n.valid8=n.valid8||{};n.fn.extend({valid8:function(t){return this.each(function(){n(this).data("valid",!1);var i={regularExpressions:[],ajaxRequests:[],jsFunctions:[],validationEvents:["keyup","blur"],validationFrequency:600,values:null,defaultErrorMessage:"必須項目です。"};t=t||{};typeof t=="string"&&(t={defaultErrorMessage:t});n.valid8=t.extendOptions||n.valid8;n(this).data("settings",n.extend(n.extend(i,t),n.valid8));this.type=="checkbox"?(i.regularExpressions=[{expression:/^true$/,errormessage:i.defaultErrorMessage}],i.validationEvents=["click"]):i.regularExpressions=[{expression:/^.+$/,errormessage:i.defaultErrorMessage}];o(this)})},isValid:function(){var t=!0;return this.each(function(){i(this);n(this).data("valid")==!1&&(t=!1)}),t}})})(jQuery)